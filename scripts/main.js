/**
 * almond 0.2.6 Copyright (c) 2011-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

!function(){var t="function"==typeof define&&define.amd,e="object"==typeof exports,n=null,r=function(){};e?(r=require,n=global):n=window,factory=function(){var t,e,r;return function(n){function o(t,e){return j.call(t,e)}function i(t,e){var n,r,o,i,a,s,c,l,p,u,m=e&&e.split("/"),f=v.map,g=f&&f["*"]||{};if(t&&"."===t.charAt(0))if(e){for(m=m.slice(0,m.length-1),t=m.concat(t.split("/")),l=0;l<t.length;l+=1)if(u=t[l],"."===u)t.splice(l,1),l-=1;else if(".."===u){if(1===l&&(".."===t[2]||".."===t[0]))break;l>0&&(t.splice(l-1,2),l-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((m||g)&&f){for(n=t.split("/"),l=n.length;l>0;l-=1){if(r=n.slice(0,l).join("/"),m)for(p=m.length;p>0;p-=1)if(o=f[m.slice(0,p).join("/")],o&&(o=o[r])){i=o,a=l;break}if(i)break;!s&&g&&g[r]&&(s=g[r],c=l)}!i&&s&&(i=s,a=c),i&&(n.splice(0,a,i),t=n.join("/"))}return t}function a(t,e){return function(){return f.apply(n,x.call(arguments,0).concat([t,e]))}}function s(t){return function(e){return i(e,t)}}function c(t){return function(e){h[t]=e}}function l(t){if(o(b,t)){var e=b[t];delete b[t],y[t]=!0,m.apply(n,e)}if(!o(h,t)&&!o(y,t))throw new Error("No "+t);return h[t]}function p(t){var e,n=t?t.indexOf("!"):-1;return n>-1&&(e=t.substring(0,n),t=t.substring(n+1,t.length)),[e,t]}function u(t){return function(){return v&&v.config&&v.config[t]||{}}}var m,f,g,d,h={},b={},v={},y={},j=Object.prototype.hasOwnProperty,x=[].slice;g=function(t,e){var n,r=p(t),o=r[0];return t=r[1],o&&(o=i(o,e),n=l(o)),o?t=n&&n.normalize?n.normalize(t,s(e)):i(t,e):(t=i(t,e),r=p(t),o=r[0],t=r[1],o&&(n=l(o))),{f:o?o+"!"+t:t,n:t,pr:o,p:n}},d={require:function(t){return a(t)},exports:function(t){var e=h[t];return"undefined"!=typeof e?e:h[t]={}},module:function(t){return{id:t,uri:"",exports:h[t],config:u(t)}}},m=function(t,e,r,i){var s,p,u,m,f,v,j=[];if(i=i||t,"function"==typeof r){for(e=!e.length&&r.length?["require","exports","module"]:e,f=0;f<e.length;f+=1)if(m=g(e[f],i),p=m.f,"require"===p)j[f]=d.require(t);else if("exports"===p)j[f]=d.exports(t),v=!0;else if("module"===p)s=j[f]=d.module(t);else if(o(h,p)||o(b,p)||o(y,p))j[f]=l(p);else{if(!m.p)throw new Error(t+" missing "+p);m.p.load(m.n,a(i,!0),c(p),{}),j[f]=h[p]}u=r.apply(h[t],j),t&&(s&&s.exports!==n&&s.exports!==h[t]?h[t]=s.exports:u===n&&v||(h[t]=u))}else t&&(h[t]=r)},t=e=f=function(t,e,r,o,i){return"string"==typeof t?d[t]?d[t](e):l(g(t,e).f):(t.splice||(v=t,e.splice?(t=e,e=r,r=null):t=n),e=e||function(){},"function"==typeof r&&(r=o,o=i),o?m(n,t,e,r):setTimeout(function(){m(n,t,e,r)},4),f)},f.config=function(t){return v=t,v.deps&&f(v.deps,v.callback),f},t._defined=h,r=function(t,e,n){e.splice||(n=e,e=[]),o(h,t)||o(b,t)||(b[t]=[t,e,n])},r.amd={jQuery:!0}}(),r("almond",function(){}),function(t){r("classes/portfolio_slides",["require","exports","module"],function(e,n,r){var o;return r.exports=o=function(){function e(t){if(this.projects=t,"object"!=typeof this.projects)throw new Error("You should pass input data of projects");this.from_above=document.getElementById("container"),this.objs=[],this.createDom()}return e.prototype.createDom=function(){var t,e,n,r,o,i,a;t=document.getElementById("portfolio"),n=document.createDocumentFragment(),a=this.projects;for(i in a)e=a[i],o=document.createElement("a"),o.className="prtf_link",o.setAttribute("href","/project/"+i),r=document.createElement("div"),r.id="prtf_"+i,r.className="prtf-banner-img",r.style.backgroundImage="url(/images/portfolio/"+i+"/banner.jpg)",r.dataset.name=i,o.appendChild(r),n.appendChild(o),this.objs[i]=r;return t.appendChild(n)},e.prototype.reDraw=function(e){var n,r,o,i,a,s,c;r=0,s=this.objs,c=[];for(i in s)n=s[i],e>=400*r&&e<=400*r+2*t.innerHeight&&(o=e/4-270+500*r,a=o.toFixed(3),this.objs[i].style.backgroundPosition="50% "+a+"px"),c.push(r++);return c},e.prototype.scrollController=function(e){var n,r;return n=e.pageYOffset||e.scrollTop,r=t.innerHeight+n-this.from_above.scrollHeight,r>0?this.reDraw(r):void 0},e}(),r.exports})}(n),function(t){r("classes/portfolio_overlay",["require","exports","module"],function(e,n,r){var o,i=function(t,e){return function(){return t.apply(e,arguments)}};return r.exports=o=function(){function e(e,n){this.projects=e,this.bg_animation=n,this.popState=i(this.popState,this),this.main=document.getElementById("page_main"),this.container=document.getElementById("portfolio_overlay"),this.loadFromUrl(),this.initClickEvents(),t.addEventListener("popstate",this.popState),this.preloadFirstImages()}return e.prototype.createDom=function(t){var e,n,r,o,i,a,s,c,l,p,u,m,f,g,d;for(a=document.createDocumentFragment(),i=document.createElement("div"),i.id="prtf_box_"+t.name,i.className="prtf_box",i.style.backgroundColor="rgba("+t.bg_rgba+")",d=t.images,m=0,g=d.length;g>m;m++){for(l=d[m],t.link?(e=document.createElement("a"),e.href=t.link,e.target="_blank"):e=document.createElement("div"),e.className="prtf-img-box",s=document.createElement("div"),s.className="prtf-img-header",o=f=0;2>=f;o=++f)r=document.createElement("span"),s.appendChild(r);c=document.createElement("img"),c.className="prtf-img",c.src="/images/portfolio/"+t.name+"/"+l,e.appendChild(s),e.appendChild(c),i.appendChild(e)}return n=document.createElement("div"),n.className="nav-btns-box",u=document.createElement("a"),u.href="/",u.className="nav-btn prew-btn",u.innerHTML="To main",p=document.createElement("a"),p.href="/project/"+this.getNextProjectName(),p.className="nav-btn next-btn",p.innerHTML="Next project",n.appendChild(u),n.appendChild(p),i.appendChild(n),a.appendChild(i),this.container.appendChild(a)},e.prototype.animate=function(){var t,e,n,r,o,i,a,s,c,l=this;return r=this.main,c=this.container,o="pt-page",t="pt-page-current",i="pt-page-ontop",a="pt-page-rotateRoomLeftOut",e="pt-page-rotateRoomLeftIn",s="pt-page-rotateRoomRightOut",n="pt-page-rotateRoomRightIn",{toLeft:function(){return c.className=""+o+" "+t+" "+s,r.className=""+o+" "+t+" "+n,setTimeout(function(){return c.className=""+o,r.className=""+o+" "+t},1e3)},toRight:function(){return r.className=""+o+" "+t+" "+a,c.className=""+o+" "+t+" "+e,setTimeout(function(){return r.className=""+o,c.className=""+o+" "+t},1e3)},toNext:function(){return r=document.getElementById("prtf_box_"+l.getPrewProjectName()),c=document.getElementById("prtf_box_"+l.curr_project),r.className=""+o+" "+t+" pt-page-rotateRoomTopOut",c.className=""+o+" "+t+" pt-page-rotateRoomTopIn",setTimeout(function(){return r.remove(),c.className="prtf_box "+t},1e3)}}},e.prototype.showProject=function(t){var e,n=this;return this.bg_animation.stop(),this.curr_project=t,this.preloadImages(this.getNextProjectName()),e=this.projects[t],e.name=t,this.createDom(e),this.registerBackEvent(),this.registerNextEvent(),{fromMain:function(){return n.animate().toRight()},fromProject:function(){return n.animate().toNext()}}},e.prototype.clearContainer=function(t){var e=this;return null==t&&(t=1e3),0===t?this.container.innerHTML="":setTimeout(function(){return e.container.innerHTML=""},t)},e.prototype.registerBackEvent=function(){var t,e,n,r,o,i;for(e=function(t){return t.preventDefault(),this.animate().toLeft(),this.clearContainer()},n=document.getElementsByClassName("prew-btn"),i=[],r=0,o=n.length;o>r;r++)t=n[r],i.push(t.addEventListener("click",e.bind(this)));return i},e.prototype.registerNextEvent=function(){var t,e,n,r,o,i;for(e=function(t){var e;return t.preventDefault(),e=this.getNextProjectName(),e?this.showProject(e).fromProject():(this.animate().toLeft(),this.clearContainer())},n=document.getElementsByClassName("next-btn"),i=[],r=0,o=n.length;o>r;r++)t=n[r],i.push(t.addEventListener("click",e.bind(this)));return i},e.prototype.getNextProjectName=function(){var t,e;return e=Object.keys(this.projects),t=e.indexOf(this.curr_project),e[t+1]},e.prototype.getPrewProjectName=function(){var t,e;return e=Object.keys(this.projects),t=e.indexOf(this.curr_project),e[t-1]},e.prototype.loadFromUrl=function(){var e,n;return e=t.location.pathname,n=e.split("/"),"project"===n[1]&&n[2]?(history.pushState({index:!1},"Main","/"),history.pushState({name:n[2],from_main:!0},n[2],"/project/"+n[2]),this.showProject(n[2]).fromMain()):void 0},e.prototype.popState=function(t){var e,n;return console.log("Loaded history state ",null!=(n=t.state)?n:{index:t.state}),e=t.state,e&&(e.name&&(e.from_main===!0?(this.clearContainer(0),this.showProject(e.name).fromMain()):console.log("TODO: Draw prew animation")),e.index===!1)?this.animate().toLeft():void 0},e.prototype.initClickEvents=function(){var t,e=this;return t=document.getElementById("portfolio"),t.addEventListener("click",function(t){var n;return t.preventDefault(),n=t.target.dataset,history.pushState({name:n.name,from_main:!0},n.name,"/project/"+n.name),e.clearContainer(0),e.showProject(n.name).fromMain()})},e.prototype.preloadImages=function(t){var e,n,r,o,i,a,s;if(r=this.projects[t]){for(a=r.images,s=[],o=0,i=a.length;i>o;o++)n=a[o],e=new Image,s.push(e.src="/images/portfolio/"+t+"/"+n);return s}},e.prototype.preloadFirstImages=function(){var t,e;return t=Object.keys(this.projects),e=t[0],this.preloadImages(e)},e}(),r.exports})}(n),function(t){r("classes/skillbars",["require","exports","module"],function(e,n,r){var o;return r.exports=o=function(){function e(e){var n,r,o,i;this.config=e,this.bar_width=300,r=document.getElementById("header"),this.start=r.scrollHeight-t.innerHeight+220,i=this.config;for(o in i)n=i[o],this.createDom(o,n)}return e.prototype.getAbilityLevel=function(t){switch(!1){case!(.3>=t):return"basic";case!(.6>=t):return"intermediate";case!(.8>=t):return"advanced";case!(1>=t):return"good";default:return"excellent"}},e.prototype.createDom=function(t,e){var n,r,o,i,a,s,c,l,p,u;s=document.getElementById("skills"),a=document.createElement("div"),u=[];for(o in e){if(c=e[o],a=document.getElementById(t),!a)throw new Error("Cannot create skills group with id #"+t);a.className="group "+t,u.push(function(){var e,o,s;for(s=[],e=0,o=c.length;o>e;e++)l=c[e],i=document.createElement("div"),i.className="box",p=document.createElement("label"),p.className="label",p.innerHTML=l.name,n=document.createElement("div"),n.className="bar "+t,n.dataset.width=this.bar_width*l.progress,r=document.createElement("span"),r.innerHTML=this.getAbilityLevel(l.progress),n.appendChild(r),i.appendChild(p),i.appendChild(n),s.push(a.appendChild(i));return s}.call(this))}return u},e.prototype.animateBars=function(t){var e,n,r;return r=document.getElementById(t),r.style.disabled!==!0?(r.style.disabled=!0,n=r.getElementsByClassName("box"),e=function(t){var e,n,r;return n=new Date,e=t.delta,r=setInterval(function(){var e;return e=(new Date-n)/t.duration,e>1&&(e=1),t.step(t.delta(e)),1===e?(clearInterval(r),t.complete&&t.complete()):void 0},t.delay||13)},e({delay:10,duration:1600,delta:function(t){return Math.pow(t,4)},step:function(t){var e,r,o,i;for(i=[],r=0,o=n.length;o>r;r++)e=n[r],i.push(function(e){var n,r;return n=e.getElementsByClassName("bar"),r=e.getElementsByTagName("span"),n[0].style.width=n[0].dataset.width*t+"px",r[0].style.opacity=t}(e));return i}})):void 0},e.prototype.scrollController=function(t){var e,n,r,o,i;if(r=t.pageYOffset||t.scrollTop,e=0,r>=this.start&&1828>=r){o=this.config,i=[];for(n in o)t=o[n],r>=this.start+450*e&&this.animateBars(n),i.push(e++);return i}},e}(),r.exports})}(n),function(t){r("classes/navigation",["require","exports","module"],function(e,n,r){var o,i=function(t,e){return function(){return t.apply(e,arguments)}};return r.exports=o=function(){function e(){this.popState=i(this.popState,this),t.addEventListener("popstate",this.popState),this.container=document.getElementById("page_main"),this.onMenuClick(),this.loadFromUrl()}var n;return e.prototype.popState=function(t){var e;if(t.state){if(t.state.anchor)return e=this.elmYPosition(t.state.anchor),n(this.container,e);if(t.state.index===!0)return n(this.container,0)}},e.prototype.onHeaderClick=function(){var t,e=this;return t=document.getElementById("logo_box"),t.addEventListener("click",function(){return n(e.container,750)})},n=function(t,e){var n,r,o,i,a,s,c,l,p,u;if(s=t.scrollTop,r=e>s?e-s:s-e,a=Math.round(r/100),50>a&&(a=20),c=Math.round(r/25),i=e>s?s+c:s-c,l=0,n=function(){return t.scrollTop=this.leap},e>s){for(o=s,p=[];e>o;)setTimeout(n.bind({leap:i}),l*a),i+=c,i>e&&(i=e),l++,p.push(o+=c);return p}for(o=s,u=[];o>e;)setTimeout(n.bind({leap:i}),l*a),i-=c,e>i&&(i=e),l++,u.push(o-=c);return u},e.prototype.elmYPosition=function(t){var e,n,r,o;if(n=t.split("/"),e=document.getElementById(t),!e)throw new Error("No element with id #"+t);for(o=e.offsetTop,r=e;r.offsetParent;)r=r.offsetParent,o+=r.offsetTop;return o},e.prototype.onMenuClick=function(){var t,e,r,o,i,a,s=this;for(r=document.getElementsByClassName("main_manu")[0],e=r.getElementsByTagName("a"),a=[],o=0,i=e.length;i>o;o++)t=e[o],a.push(t.addEventListener("click",function(t){var e,r;return t.preventDefault(),e=t.target.getAttribute("href").split("/"),history.pushState({index:!1,anchor:e[2]},"Section #{path[2]}","/to/"+e[2]),r=s.elmYPosition(e[2]),n(s.container,r)}));return a},e.prototype.loadFromUrl=function(){var e,r,o;return e=t.location.pathname,r=e.split("/"),"to"===r[1]&&r[2]?(history.pushState({index:!0},"Main","/"),history.pushState({anchor:r[2],index:!1},r[2],"/to/"+r[2]),o=this.elmYPosition(r[2]),n(this.container,o)):void 0},e}(),r.exports})}(n),function(){r("classes/footer",["require","exports","module"],function(t,e,n){var r;return n.exports=r=function(){function t(){this.btns=document.getElementsByClassName("footer-buttons"),this.footer=document.getElementsByClassName("footer")[0],this.container=document.getElementById("container"),this.portfolio=document.getElementById("portfolio"),this.checked=!1}return t.prototype.scrollController=function(t){var e,n,r,o,i,a,s,c,l;if(this.checked===!1&&(r=this.container.clientHeight+this.portfolio.clientHeight,o=t.pageYOffset||t.scrollTop,o>=r)){for(this.checked=!0,i=function(){return this.className=this.className.split(" ")[1]},c=this.btns[0].children,l=[],a=0,s=c.length;s>a;a++)e=c[a],n=Math.floor(2e3*Math.random()+1),l.push(setTimeout(i.bind(e),n));return l}},t}(),n.exports})}(n),function(){r("classes/bg_animation",["require","exports","module"],function(t,e,n){var r;return n.exports=r=function(){function t(){var t;this.el_back=document.getElementById("narrows_back"),this.el_middle=document.getElementById("narrows_middle"),t=document.getElementById("container"),this.container_height=t.scrollHeight,this.off=!1,this.permament=!1,this.checkMobileDevice()}return t.prototype.scrollController=function(t){var e;if(e=t.pageYOffset||t.scrollTop,e>=this.container_height){if(this.off===!1)return this.stop()}else if(this.off===!0)return this.start()},t.prototype.stop=function(){return this.off===!1?(console.log("Bg anmation disabled."),this.el_back.className="",this.el_middle.className="",this.off=!0):void 0},t.prototype.start=function(){return this.permament===!1?(console.log("Bg animation enabled."),this.el_back.className="animated",this.el_middle.className="animated",this.off=!1):void 0},t.prototype.checkMobileDevice=function(){return document.body.offsetWidth<=600?(this.permament=!0,this.stop()):void 0},t}(),n.exports})}(n),function(){r("config/portfolio_config",["require","exports","module"],function(t,e,n){return n.exports={oldchina:{bg_rgba:"188, 55, 0, 1",images:["01.jpg","02.jpg","03.jpg"],link:"http://oldchina.ru/"},"4sound":{bg_rgba:"220, 150, 39, .8",images:["01.jpg","02.jpg"],link:"http://4sound.ru/"},otagai:{bg_rgba:"238, 246, 248, .5",images:["01.jpg"],link:"http://otagai.maxsvargal.com/"},alenushka:{bg_rgba:"133, 149, 50, .8",images:["01.jpg"],link:"http://detsad-alenushka.ru/"},"style-print":{bg_rgba:"104, 53, 8, .7",images:["01.jpg","02.jpg","03.jpg"],link:"http://style-printing.maxsvargal.com/"},undermoscow:{bg_rgba:"75, 127, 140, 1",images:["01.jpg","02.jpg","03.jpg"],link:"http://www.undermoskow.ru/"},dobrochan:{bg_rgba:"213, 155, 118, .7",images:["01.jpg"],link:"http://dobrochan.maxsvargal.com/"},hightway:{bg_rgba:"124, 137, 143, 1",images:["01.jpg","02.jpg"],link:"http://hightway.maxsvargal.com"},pro100doc:{bg_rgba:"226, 124, 104, 1",images:["01.jpg"],link:"http://pro100doc.ru/"},imaginarium:{bg_rgba:"213, 155, 118, .8",images:["01.jpg","02.jpg"]},maplestory:{bg_rgba:"72, 120, 218, 1",images:["01.jpg","02.jpg"]},roma:{bg_rgba:"124, 137, 143, .4",images:["01.jpg","02.jpg"]},bluewind:{bg_rgba:"114, 161, 191, .9",images:["01.jpg"]},vahtang:{bg_rgba:"81, 63, 27, 1",images:["01.jpg"],link:"http://vahtang.tv/"},oldmaxsvargal:{bg_rgba:"98, 97, 93, 1",images:["01.jpg"],link:"http://old.maxsvargal.com/"}},n.exports})}(n),function(){r("config/skillbars_config",["require","exports","module"],function(t,e,n){return n.exports={design:{data:[{name:"web-design",progress:.9},{name:"typography",progress:.6},{name:"illustrations",progress:.3},{name:"usability",progress:1}]},frontend:{data:[{name:"html (jade, haml)",progress:1},{name:"css (stylus, sass)",progress:.9},{name:"javascript",progress:.8},{name:"jquery",progress:.75},{name:"coffeescript",progress:.85}]},backend:{data:[{name:"node.js",progress:.75},{name:"ruby on rails",progress:.41},{name:"php (yii, kohana)",progress:.6},{name:"sql (mysql, postgress)",progress:.6},{name:"nosql (mongodb, redis)",progress:.7}]},another:{data:[{name:"tdd & bdd",progress:.3},{name:"git",progress:.65},{name:"linux",progress:.61}]}},n.exports})}(n),function(){r("main",["require","exports","module","./classes/portfolio_slides","./classes/portfolio_overlay","./classes/skillbars","./classes/navigation","./classes/footer","./classes/bg_animation","./config/portfolio_config","./config/skillbars_config"],function(t,e,n){var r,o,i,a,s,c,l,p,u;return s=t("./classes/portfolio_slides"),a=t("./classes/portfolio_overlay"),c=t("./classes/skillbars"),i=t("./classes/navigation"),o=t("./classes/footer"),r=t("./classes/bg_animation"),p=t("./config/portfolio_config"),u=t("./config/skillbars_config"),l=function(){var t,e,n,l,m,f,g;return g=new c(u),f=new s(p),t=new r,l=new a(p,t),n=new i,e=new o,m=document.getElementById("page_main"),m.onscroll=function(n){return t.scrollController(n.target),f.scrollController(n.target),g.scrollController(n.target),e.scrollController(n.target)}}(),n.exports})}(n),e("main")},t?define([],factory):e?module.exports=factory():factory()}();